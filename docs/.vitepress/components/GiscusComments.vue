<!--<template>-->
<!--    <div ref="giscusContainer"></div>-->
<!--</template>-->

<!--<script setup>-->
<!--import { onMounted, ref, onBeforeUnmount } from 'vue'-->
<!--import { createGiscus } from 'giscus'-->

<!--const giscusContainer = ref(null)-->
<!--let giscusInstance = null-->

<!--onMounted(() => {-->
<!--    if (giscusContainer.value) {-->
<!--        giscusInstance = createGiscus({-->
<!--            container: giscusContainer.value,-->
<!--            repo: 'username/repo', // –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π-->
<!--            repoId: 'MDEwOlJlcG9zaXRvcnkxMjM0NTY3OA==', // –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à repoId-->
<!--            category: 'General', // –∫–∞—Ç–µ–≥–æ—Ä–∏—è –æ–±—Å—É–∂–¥–µ–Ω–∏–π-->
<!--            categoryId: 'DIC_kwDOA1ABC4B4', // id –∫–∞—Ç–µ–≥–æ—Ä–∏–∏-->
<!--            mapping: 'pathname', // 'pathname' = URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã-->
<!--            reactionsEnabled: true, // –ª–∞–π–∫–∏ üëç-->
<!--            emitMetadata: false,-->
<!--            inputPosition: 'bottom', // –ø–æ–ª–µ –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è —Å–Ω–∏–∑—É-->
<!--            theme: 'light', // –º–æ–∂–Ω–æ 'dark', 'preferred_color_scheme', 'transparent_dark' –∏ —Ç.–¥.-->
<!--            lang: 'en', // —è–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞-->
<!--        })-->
<!--    }-->
<!--})-->

<!--onBeforeUnmount(() => {-->
<!--    // —É–¥–∞–ª—è–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –¥—Ä—É–≥—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É-->
<!--    if (giscusContainer.value) {-->
<!--        giscusContainer.value.innerHTML = ''-->
<!--    }-->
<!--})-->
<!--</script>-->

<!--<style scoped>-->
<!--/* –Ω–µ–º–Ω–æ–≥–æ –æ—Ç—Å—Ç—É–ø–∞ —Å–≤–µ—Ä—Ö—É */-->
<!--div[ref='giscusContainer'] {-->
<!--    margin-top: 2rem;-->
<!--}-->
<!--</style>-->

<template>
    <div ref="giscusContainer"></div>
</template>

<script setup>
import { ref, onMounted, onBeforeUnmount } from 'vue'

const giscusContainer = ref(null)
let scriptEl = null

// –ü–∞—Ä–∞–º–µ—Ç—Ä—ã Giscus ‚Äî –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Å–≤–æ–∏
const GISCUS_CONFIG = {
    repo: 'MarkusFx/docs', // –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
    repoId: 'R_kgDOO4Wdjg', // –≤–∞—à repoId
    category: 'General', // –∫–∞—Ç–µ–≥–æ—Ä–∏—è –æ–±—Å—É–∂–¥–µ–Ω–∏–π
    categoryId: 'DIC_kwDOO4Wdjs4C2HJq', // ID –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    mapping: 'pathname', // –ø—Ä–∏–≤—è–∑–∫–∞ –∫ URL
    reactionsEnabled: '1',
    emitMetadata: '0',
    inputPosition: 'bottom',
    theme: 'preferred_color_scheme',
    lang: 'ru',
}

onMounted(() => {
    if (!giscusContainer.value) return

    // —Å–æ–∑–¥–∞–µ–º —Å–∫—Ä–∏–ø—Ç Giscus
    scriptEl = document.createElement('script')
    scriptEl.src = 'https://giscus.app/client.js'
    Object.entries(GISCUS_CONFIG).forEach(([key, value]) => {
        scriptEl.setAttribute(
            `data-${key.replace(/[A-Z]/g, (m) => '-' + m.toLowerCase())}`,
            value,
        )
    })
    scriptEl.async = true
    scriptEl.crossOrigin = 'anonymous'

    giscusContainer.value.appendChild(scriptEl)
})

onBeforeUnmount(() => {
    // —á–∏—Å—Ç–∏–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ
    if (giscusContainer.value) {
        giscusContainer.value.innerHTML = ''
    }
})
</script>

<style scoped>
div[ref='giscusContainer'] {
    margin-top: 2rem;
}
</style>
